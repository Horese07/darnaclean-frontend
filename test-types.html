<!DOCTYPE html>
<html>
<head>
    <title>Test Types Dashboard Admin</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ccc; margin: 20px 0; padding: 15px; border-radius: 5px; }
        .error { color: red; }
        .success { color: green; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 3px; overflow-x: auto; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .type-info { background: #e7f3ff; padding: 10px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Test Types Dashboard Admin</h1>
    
    <div class="test-section">
        <h3>Test Gestion des Types</h3>
        <button onclick="testTypes()">Tester la Gestion des Types</button>
        <div id="types-result"></div>
    </div>
    
    <div class="test-section">
        <h3>Test Conversion des Données</h3>
        <button onclick="testConversions()">Tester les Conversions</button>
        <div id="conversions-result"></div>
    </div>

    <script>
        function testTypes() {
            const resultDiv = document.getElementById('types-result');
            
            // Simuler les données de l'API
            const mockProduct = {
                id: 1,
                name_fr: "Test Produit",
                name_en: "Test Product",
                name_ar: "منتج اختبار",
                price: "25.50", // Prix comme chaîne
                stock: "150",   // Stock comme chaîne
                category_id: "1", // Category ID comme chaîne
                currency: "MAD",
                is_active: true
            };
            
            // Test de conversion des types
            const convertedPrice = typeof mockProduct.price === 'string' ? parseFloat(mockProduct.price) : mockProduct.price;
            const convertedStock = typeof mockProduct.stock === 'string' ? parseInt(mockProduct.stock) : mockProduct.stock;
            const convertedCategoryId = typeof mockProduct.category_id === 'string' ? parseInt(mockProduct.category_id) : mockProduct.category_id;
            
            resultDiv.innerHTML = `
                <div class="success">
                    ✅ Test des types réussi !<br><br>
                    
                    <div class="type-info">
                        <strong>Données originales (API):</strong><br>
                        - price: "${mockProduct.price}" (type: ${typeof mockProduct.price})<br>
                        - stock: "${mockProduct.stock}" (type: ${typeof mockProduct.stock})<br>
                        - category_id: "${mockProduct.category_id}" (type: ${typeof mockProduct.category_id})
                    </div>
                    
                    <div class="type-info">
                        <strong>Données converties:</strong><br>
                        - price: ${convertedPrice} (type: ${typeof convertedPrice})<br>
                        - stock: ${convertedStock} (type: ${typeof convertedStock})<br>
                        - category_id: ${convertedCategoryId} (type: ${typeof convertedCategoryId})
                    </div>
                    
                    <div class="type-info">
                        <strong>Tests de validation:</strong><br>
                        - price.toFixed(2): ${convertedPrice.toFixed(2)} ✅<br>
                        - stock > 10: ${convertedStock > 10} ✅<br>
                        - category_id === 1: ${convertedCategoryId === 1} ✅
                    </div>
                </div>
                
                <pre>${JSON.stringify(mockProduct, null, 2)}</pre>
            `;
        }

        function testConversions() {
            const resultDiv = document.getElementById('conversions-result');
            
            // Test de différentes combinaisons de types
            const testCases = [
                { price: "25.50", stock: "150", category_id: "1" },
                { price: 25.50, stock: 150, category_id: 1 },
                { price: "0", stock: "0", category_id: "0" },
                { price: 0, stock: 0, category_id: 0 }
            ];
            
            let results = '';
            
            testCases.forEach((testCase, index) => {
                const convertedPrice = typeof testCase.price === 'string' ? parseFloat(testCase.price) : testCase.price;
                const convertedStock = typeof testCase.stock === 'string' ? parseInt(testCase.stock) : testCase.stock;
                const convertedCategoryId = typeof testCase.category_id === 'string' ? parseInt(testCase.category_id) : testCase.category_id;
                
                results += `
                    <div class="type-info">
                        <strong>Test Case ${index + 1}:</strong><br>
                        Original: price=${testCase.price}(${typeof testCase.price}), stock=${testCase.stock}(${typeof testCase.stock}), category_id=${testCase.category_id}(${typeof testCase.category_id})<br>
                        Converti: price=${convertedPrice}(${typeof convertedPrice}), stock=${convertedStock}(${typeof convertedStock}), category_id=${convertedCategoryId}(${typeof convertedCategoryId})<br>
                        <strong>Status:</strong> ${isNaN(convertedPrice) || isNaN(convertedStock) || isNaN(convertedCategoryId) ? '❌ Erreur de conversion' : '✅ Conversion réussie'}
                    </div>
                `;
            });
            
            resultDiv.innerHTML = `
                <div class="success">
                    ✅ Test des conversions réussi !<br><br>
                    ${results}
                </div>
            `;
        }
    </script>
</body>
</html>
